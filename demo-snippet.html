<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/paper-styles/color.html">
<link rel="import" href="bower_components/prism-highlighter/prism-highlighter.html">
<link rel="import" href="bower_components/marked-element/marked-element.html">

<dom-module id="demo-snippet">
  <style>
    :host {
      background-color: white;
      @apply(--layout-vertical);
      @apply(--center-justified);
      @apply(--shadow-elevation-2dp);
    }

    .header {
      background-color: var(--paper-teal-500);
      color: white;
      padding: 14px;
      margin: 0;
      font-weight: 300;
      font-size: 18px;
    }

    .demo {
      @apply(--layout-horizontal);
      padding: 24px;
      margin-left: auto;
      margin-right: auto;
    }

    marked-element {
      background-color: var(--paper-grey-50);
      border: solid #e5e5e5;
      border-width: 1px 0;
      overflow-x: auto;
      padding: 12px 24px;
      font-size: 15px;
      word-wrap: break-word;
    }

  </style>
  <template>
      <div class="header">[[title]]</div>

      <div id="demo" class="demo">
        <content id="content"></content>
      </div>

      <prism-highlighter></prism-highlighter>
      <marked-element id="m" markdown="[[_getMarkdown(title)]]"></marked-element>
  </template>

  <script>
    Polymer({
      is: 'demo-snippet',

      properties: {
        title: {
          type: String,
          value: ''
        },

        type: {
          type: String,
          value: 'html'
        }
      },

      // Lol this needs to be a mutation observer.
      _getMarkdown: function(title) {
        var nodes = Polymer.dom(this).queryDistributedElements('*');

        var markdown = '```\n';
        for (var i = 0; i < nodes.length; i++) {
          markdown += nodes[i].outerHTML + '\n';
        }

        // Boolean properties, sigh. This is probably wrong.
        markdown = markdown.replace(/=""/g, '');
        markdown += '```';

        return markdown;
      }
    });
  </script>

</dom-module>
